# Документация: Система достижений для избранных гайдов

## Описание изменений

Реализована возможность выборочно давать достижения за просмотр определённых гайдов. Теперь при создании или редактировании гайда администратор может установить галочку "Давать достижение за просмотр", чтобы контролировать, за какие гайды пользователи получают достижения.

## Что было изменено

### 1. База данных
- **Миграция**: `2025_10_09_000000_add_gives_achievement_to_zombie_guides_table.php`
  - Добавлено поле `gives_achievement` (boolean, default: true) в таблицу `zombie_guides`
  
- **Миграция**: `2025_10_09_000001_set_default_gives_achievement_for_existing_guides.php`
  - Установлено значение `true` для всех существующих гайдов

### 2. Backend (PHP)

#### Модель `ZombieGuide`
- Добавлено поле `gives_achievement` в массивы `$fillable` и `$casts`

#### Контроллер `ZombieGuideController`
- Метод `completeGuide()`: Добавлена проверка флага `gives_achievement` перед выдачей достижения
- Если `gives_achievement = false`, достижение не выдаётся

#### Контроллер `Admin/GuideController`
- Методы `store()` и `update()`: Добавлена валидация для поля `gives_achievement`

### 3. Frontend (Vue.js)

#### Форма создания гайда (`Admin/Guides/Create.vue`)
- Добавлен чекбокс "Давать достижение за просмотр"
- Значение по умолчанию: `true` (включено)
- Добавлено поле в объект формы

#### Форма редактирования гайда (`Admin/Guides/Edit.vue`)
- Добавлен чекбокс "Давать достижение за просмотр"
- Отображается текущее значение из базы данных
- Добавлено поле в объект формы

## Как использовать

### Для администраторов:

1. **При создании нового гайда:**
   - Заполните все обязательные поля
   - Если хотите, чтобы за этот гайд давалось достижение, оставьте галочку "Давать достижение за просмотр" включенной
   - Если НЕ хотите давать достижение, снимите галочку
   - Сохраните гайд

2. **При редактировании существующего гайда:**
   - Откройте гайд на редактирование
   - Найдите чекбокс "Давать достижение за просмотр"
   - Установите или снимите галочку по необходимости
   - Сохраните изменения

### Для пользователей:

- При просмотре гайда с включенным флагом `gives_achievement = true`, пользователь получит достижение
- При просмотре гайда с выключенным флагом `gives_achievement = false`, достижение НЕ выдаётся (вернётся ответ 403 с сообщением "This guide does not grant an achievement")

## Технические детали

### API ответы метода `completeGuide()`

**Успешное получение достижения:**
```json
{
  "message": "Achievement unlocked!",
  "success": true
}
```

**Гайд не даёт достижения:**
```json
{
  "message": "This guide does not grant an achievement",
  "success": false
}
```
HTTP статус: 403

**Достижение уже получено ранее:**
```json
{
  "message": "Achievement already unlocked",
  "success": false
}
```

## Обратная совместимость

- Все существующие гайды автоматически получили флаг `gives_achievement = true`
- Старая функциональность полностью сохранена
- Никакие существующие достижения пользователей не затронуты

